    #### :snail: 电商
    ##### 如何解决读写分离 数据的一致性
    高并发下的数据安全，防止超发，以订单系统为列：
    1.消息队列：将订单库存资源存放到redis中，将请求一次存储消息队列
    ![](static/images/mq.png)
    2.**常见的锁有排他锁，乐观锁，悲观锁**
    - 排他锁，在进行写的时候，禁止一切的读与写。
    - 采用乐观锁+回滚：认为当写的时候，别人没有写，维护一个version，等处理好对照version，一致就没问题，否则回滚。操作不成功
    ![](static/images/data.png)
    - 采用悲观锁:认为写的时候别人也在写，采用数据库提供的锁机制：在写操作时候，myisam默认的是锁表，innodb根据是否是主键，主键则行锁，否则表锁，读操作
    innodb采用mvcc版本控制
    ![](static/images/pessLock.png)

   一般读会远多于写，放有数据改动的时候，我们会对读库和写库都进行同步。当然如果写大于读那么其实做读写分离就没多大一些，应该考虑做分库，分表了。



    ##### 分布式如何保证数据的一致性
    #####